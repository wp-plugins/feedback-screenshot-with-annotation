/* 
 * html2canvas v0.27 <http://html2canvas.hertzen.com>
 * Copyright (c) 2011 Niklas von Hertzen. All rights reserved.
 * http://www.twitter.com/niklasvh 
 * 
 * Released under MIT License
 */

/*
 * The MIT License

 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

function html2canvas(a,b){var c=b||{};this.opts=this.extendObj(c,{logging:false,ready:function(a){document.body.appendChild(a.canvas)},storageReady:function(a){a.Renderer(a.contextStacks)},iframeDefault:"default",flashCanvasPath:"http://html2canvas.hertzen.com/external/flashcanvas/flashcanvas.js",renderViewport:false,reorderZ:true,throttle:true,letterRendering:false,proxyUrl:null,logger:function(a){if(window.console&&window.console.log){window.console.log(a)}else{alert(a)}},canvasWidth:0,canvasHeight:0,useOverflow:true,renderOrder:"canvas flash html",allowImageBaseUrl:"",doNotRenderObjIds:[],doNotRenderObjClasses:[]});this.element=a;var d,e,f,g,h,i;this.imagesLoaded=0;this.images=[];this.fontData=[];this.numDraws=0;this.contextStacks=[];this.ignoreElements="IFRAME|OBJECT|PARAM";this.needReorder=false;this.blockElements=new RegExp("(BR|PARAM)");this.pageOrigin=window.location.protocol+window.location.host;this.queue=[];this.ignoreRe=new RegExp("("+this.ignoreElements+")");this.support={rangeBounds:false};if(document.createRange){var j=document.createRange();if(j.getBoundingClientRect){var k=document.createElement("boundtest");k.style.height="123px";k.style.display="block";document.getElementsByTagName("body")[0].appendChild(k);j.selectNode(k);var l=j.getBoundingClientRect();var m=l.height;if(m==123){this.support.rangeBounds=true}document.getElementsByTagName("body")[0].removeChild(k)}}this.init();return this}html2canvas.prototype.init=function(){var a=this;this.log("Finding background-images");this.images.push("start");this.getImages(this.element);this.log("Finding images");this.each(this.element.ownerDocument.images,function(b,c){a.preloadImage(a.getAttr(c,"src"))});this.images.splice(0,1);if(this.images.length==0){this.start()}};html2canvas.prototype.start=function(){if(this.images.length==0||this.imagesLoaded==this.images.length/2){this.log("Finished loading "+this.imagesLoaded+" images, Started parsing");this.bodyOverflow=document.getElementsByTagName("body")[0].style.overflow;document.getElementsByTagName("body")[0].style.overflow="hidden";var a=new this.storageContext(jQuery(document).width(),jQuery(document).height());a.opacity=this.getCSS(this.element,"opacity");var b=this.newElement(this.element,a);this.parseElement(this.element,b)}};html2canvas.prototype.stackingContext=function(a,b){this.canvas=document.createElement("canvas");this.canvas.width=a;this.canvas.height=a;if(!this.canvas.getContext){}else{this.ctx=this.canvas.getContext("2d")}this.ctx.textBaseline="bottom";return this.ctx};html2canvas.prototype.storageContext=function(a,b){this.storage=[];this.width=a;this.height=b;this.fillRect=function(a,b,c,d){this.storage.push({type:"function",name:"fillRect",arguments:[a,b,c,d]})};this.drawImage=function(a,b,c,d,e,f,g,h,i){this.storage.push({type:"function",name:"drawImage",arguments:[a,b,c,d,e,f,g,h,i]})};this.fillText=function(a,b,c){this.storage.push({type:"function",name:"fillText",arguments:[a,b,c]})};return this};html2canvas.prototype.finish=function(){this.log("Finished rendering");document.getElementsByTagName("body")[0].style.overflow=this.bodyOverflow;this.opts.ready(this)};html2canvas.prototype.drawBackground=function(a,b,c){var d=this.getCSS(a,"background-image").split(",")[0];var e=this.getCSS(a,"background-repeat").split(",")[0];if(typeof d!="undefined"&&/^(1|none)$/.test(d)==false&&/^(-webkit|-moz|linear-gradient|-o-)/.test(d)==false){d=this.backgroundImageUrl(d);var f=this.loadImage(d);var g=this.getBackgroundPosition(a,b,f),h;if(f){switch(e){case"repeat-x":this.drawbackgroundRepeatX(c,f,g,b.left,b.top,b.width,b.height);break;case"repeat-y":this.drawbackgroundRepeatY(c,f,g,b.left,b.top,b.width,b.height);break;case"no-repeat":var i=b.width-g.left,j=b.height-g.top,k=g.left,l=g.top,m=g.left+b.left,n=g.top+b.top;if(k<0){k=Math.abs(k);m+=k;i=Math.min(b.width,f.width-k)}else{i=Math.min(i,f.width);k=0}if(l<0){l=Math.abs(l);n+=l;j=Math.min(b.height,f.height-l)}else{j=Math.min(j,f.height);l=0}if(j>0&&i>0){this.drawImage(c,f,k,l,i,j,m,n,i,j);break};default:var o,p;g.top=g.top-Math.ceil(g.top/f.height)*f.height;for(h=b.top+g.top;h<b.height+b.top;){var q=Math.min(f.height,b.height+b.top-h);if(Math.floor(h+f.height)>q+h){o=q+h-h}else{o=f.height}if(h<b.top){p=b.top-h;h=b.top}else{p=0}this.drawbackgroundRepeatX(c,f,g,b.left,h,b.width,o);if(p>0){g.top+=p}h=Math.floor(h+f.height)-p}break}}else{this.log("Error loading background:"+d)}}};html2canvas.prototype.backgroundImageUrl=function(a){if(a.substr(0,5)=='url("'){a=a.substr(5);a=a.substr(0,a.length-2)}else{a=a.substr(4);a=a.substr(0,a.length-1)}return a};html2canvas.prototype.getBackgroundPosition=function(a,b,c){var d=this.getCSS(a,"backgroundPosition").split(",")[0]||"0 0";var e=d.split(" "),f,g,h;if(e.length==1){var i=e,e=[];e[0]=i,e[1]=i}if(e[0].toString().indexOf("%")!=-1){h=parseFloat(e[0])/100;g=b.width*h-c.width*h}else{g=parseInt(e[0],10)}if(e[1].toString().indexOf("%")!=-1){h=parseFloat(e[1])/100;f=b.height*h-c.height*h}else{f=parseInt(e[1],10)}var j={};j.top=f;j.left=g;return j};html2canvas.prototype.drawbackgroundRepeatY=function(a,b,c,d,e,f,g){var h,i=Math.min(b.width,f),j;c.top=c.top-Math.ceil(c.top/b.height)*b.height;for(j=e+c.top;j<g+e;){if(Math.floor(j+b.height)>g+e){h=g+e-j}else{h=b.height}this.drawBackgroundRepeat(a,b,d+c.left,j,i,h,d,e);j=Math.floor(j+b.height)}};html2canvas.prototype.drawbackgroundRepeatX=function(a,b,c,d,e,f,g){var h=Math.min(b.height,g),i,j;c.left=c.left-Math.ceil(c.left/b.width)*b.width;for(j=d+c.left;j<f+d;){if(Math.floor(j+b.width)>f+d){i=f+d-j}else{i=b.width}this.drawBackgroundRepeat(a,b,j,e+c.top,i,h,d,e);j=Math.floor(j+b.width)}};html2canvas.prototype.drawBackgroundRepeat=function(a,b,c,d,e,f,g,h){var i=0,j=0;if(g-c>0){i=g-c}if(h-d>0){j=h-d}this.drawImage(a,b,i,j,e-i,f-j,c+i,d+j,e-i,f-j)};html2canvas.prototype.getBorderData=function(a){var b=[];var c=this;this.each(["top","right","bottom","left"],function(d,e){b.push({width:parseInt(c.getCSS(a,"border-"+e+"-width"),10),color:c.getCSS(a,"border-"+e+"-color")})});return b};html2canvas.prototype.drawBorders=function(a,b,c,d){var e=c.left;var f=c.top;var g=c.width;var h=c.height;var i=this.getBorderData(a);var j=this;this.each(i,function(a,c){if(c.width>0){var k=e,l=f,m=g,n=h-i[2].width;switch(a){case 0:n=i[0].width;break;case 1:k=e+g-i[1].width;m=i[1].width;break;case 2:l=l+h-i[2].width;n=i[2].width;break;case 3:m=i[3].width;break}var o={left:k,top:l,width:m,height:n};if(d){o=j.clipBounds(o,d)}if(o.width>0&&o.height>0){j.newRect(b,k,l,o.width,o.height,c.color)}}});return i};html2canvas.prototype.newElement=function(a,b){if(this.opts.doNotRenderObjIds.length>0){if(this.inArray(a.id,this.opts.doNotRenderObjIds)){return false}}if(this.opts.doNotRenderObjClasses.length>0){for(iClass in this.opts.doNotRenderObjClasses){if(jQuery(a).hasClass(this.opts.doNotRenderObjClasses[iClass])){return false}}}var c=this.getBounds(a);var d=c.left;var e=c.top;var f=c.width;var g=c.height;var h=this,i;var j=this.getCSS(a,"background-color");var k=this.getCSS(a,"position");b=b||{};var l=this.setZ(this.getCSS(a,"zIndex"),k,b.zIndex,a.parentNode);var m=this.getCSS(a,"opacity");var n={ctx:new this.storageContext,zIndex:l,opacity:m*b.opacity,cssPosition:k};if(b.clip){n.clip=jQuery.extend({},b.clip);n.clip.height=n.clip.height-b.borders[2].width}if(this.opts.useOverflow&&/(hidden|scroll|auto)/.test(this.getCSS(a,"overflow"))&&!/(BODY)/i.test(a.nodeName)){if(n.clip){n.clip=this.clipBounds(n.clip,c)}else{n.clip=c}}var o=l.children.push(n);var p=l.children[o-1].ctx;this.setContextVariable(p,"globalAlpha",n.opacity);var q=this.drawBorders(a,p,c);n.borders=q;if(this.ignoreRe.test(a.nodeName)&&this.opts.iframeDefault!="transparent"){if(this.opts.iframeDefault=="default"){j="#efefef"}else{j=this.opts.iframeDefault}}var r={left:d+q[3].width,top:e+q[0].width,width:f-(q[1].width+q[3].width),height:g-(q[0].width+q[2].width)};if(n.clip){r=this.clipBounds(r,n.clip)}if(r.height>0&&r.width>0){this.newRect(p,r.left,r.top,r.width,r.height,j);this.drawBackground(a,r,p)}switch(a.nodeName){case"IMG":var s=true;if(this.opts.allowImageBaseUrl!=""){if(h.getAttr(a,"src").search(this.opts.allowImageBaseUrl)<0){s=false}}if(s){i=h.loadImage(h.getAttr(a,"src"));if(i){this.drawImage(p,i,0,0,i.width,i.height,d+parseInt(h.getCSS(a,"padding-left"),10)+q[3].width,e+parseInt(h.getCSS(a,"padding-top"),10)+q[0].width,c.width-(q[1].width+q[3].width+parseInt(h.getCSS(a,"padding-left"),10)+parseInt(h.getCSS(a,"padding-right"),10)),c.height-(q[0].width+q[2].width+parseInt(h.getCSS(a,"padding-top"),10)+parseInt(h.getCSS(a,"padding-bottom"),10)))}else{this.log("Error loading <img>:"+h.getAttr(a,"src"))}}break;case"INPUT":if(/^(text|url|email|submit|button|reset)$/.test(a.type)&&a.value.length>0){this.renderFormValue(a,c,n)}break;case"TEXTAREA":if(a.value.length>0){this.renderFormValue(a,c,n)}break;case"SELECT":if(a.options.length>0){this.renderFormValue(a,c,n)}break;case"LI":this.drawListItem(a,n,r);break}return l.children[o-1]};html2canvas.prototype.printText=function(a,b,c,d){if(this.trim(a).length>0){d.fillText(a,b,c);this.numDraws++}};html2canvas.prototype.newRect=function(a,b,c,d,e,f){if(f!="transparent"){this.setContextVariable(a,"fillStyle",f);a.fillRect(b,c,d,e);this.numDraws++}};html2canvas.prototype.drawImage=function(a,b,c,d,e,f,g,h,i,j){a.drawImage(b,c,d,e,f,g,h,i,j);this.numDraws++};html2canvas.prototype.renderFormValue=function(a,b,c){var d=document.createElement("valuewrap"),e=this;this.each(["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"],function(b,c){d.style[c]=e.getCSS(a,c)});d.style.borderColor="black";d.style.borderStyle="solid";d.style.display="block";d.style.position="absolute";if(/^(submit|reset|button|text|password)$/.test(a.type)||a.nodeName=="SELECT"){d.style.lineHeight=e.getCSS(a,"height")}d.style.top=b.top+"px";d.style.left=b.left+"px";if(a.nodeName=="SELECT"){var f=a.options[a.selectedIndex].text}else{var f=a.value}var g=document.createTextNode(f);d.appendChild(g);jQuery("body").append(d);this.newText(a,g,c);jQuery(d).remove()};html2canvas.prototype.getImages=function(a){var b=this;if(!this.ignoreRe.test(a.nodeName)){this.each(jQuery(a).contents(),function(a,c){var d=new RegExp("("+this.ignoreElements+")");if(!d.test(c.nodeName)){b.getImages(c)}})}if(a.nodeType==1||typeof a.nodeType=="undefined"){var c=this.getCSS(a,"background-image");if(c&&c!="1"&&c!="none"&&c.substring(0,7)!="-webkit"&&c.substring(0,3)!="-o-"&&c.substring(0,4)!="-moz"){var d=this.backgroundImageUrl(c.split(",")[0]);this.preloadImage(d)}}};html2canvas.prototype.loadImage=function(a){var b=this.getIndex(this.images,a);if(b!=-1){return this.images[b+1]}else{return false}};html2canvas.prototype.preloadImage=function(a){if(this.getIndex(this.images,a)==-1){if(this.isSameOrigin(a)){this.images.push(a);var b=new Image;var c=this;jQuery(b).load(function(){c.imagesLoaded++;c.start()});b.onerror=function(){c.images.splice(c.images.indexOf(b.src),2);c.start()};b.src=a;this.images.push(b)}else if(this.opts.proxyUrl){this.images.push(a);var b=new Image;this.proxyGetImage(a,b);this.images.push(b)}}};html2canvas.prototype.proxyGetImage=function(a,b){var c=this;var d=document.createElement("a");d.href=a;a=d.href;jQuery.ajax({data:{xhr2:false,url:a},url:this.opts.proxyUrl,dataType:"jsonp",success:function(d){if(d.substring(0,6)=="error:"){c.images.splice(c.images.indexOf(a),2);c.start();c.log("Proxy was unable to load "+a+" "+d)}else{b.onload=function(){c.imagesLoaded++;c.start()};b.src=d}},error:function(){c.images.splice(c.images.indexOf(a),2);c.start()}})};html2canvas.prototype.Renderer=function(a){var b=this;this.log("Renderer initiated");this.each(this.opts.renderOrder.split(" "),function(c,d){switch(d){case"canvas":b.canvas=document.createElement("canvas");if(b.canvas.getContext){b.canvasRenderer(a);b.log("Using canvas renderer");return false}break;case"flash":break;case"html":b.log("Using HTML renderer");return false;break}});return this};html2canvas.prototype.throttler=function(a){};html2canvas.prototype.canvasRenderContext=function(a,b){b.textBaseline="bottom";var c=this;if(a.clip){b.save();b.beginPath();b.rect(a.clip.left,a.clip.top,a.clip.width,a.clip.height);b.clip()}if(a.ctx.storage){c.each(a.ctx.storage,function(a,d){switch(d.type){case"variable":b[d.name]=d.arguments;break;case"function":if(d.name=="fillRect"){b.fillRect(d.arguments[0],d.arguments[1],d.arguments[2],d.arguments[3])}else if(d.name=="fillText"){b.fillText(d.arguments[0],d.arguments[1],d.arguments[2])}else if(d.name=="drawImage"){if(d.arguments[8]>0&&d.arguments[7]){b.drawImage(d.arguments[0],d.arguments[1],d.arguments[2],d.arguments[3],d.arguments[4],d.arguments[5],d.arguments[6],d.arguments[7],d.arguments[8])}}else{c.log(d)}break;default:}})}if(a.clip){b.restore()}};html2canvas.prototype.canvasRenderStorage=function(a,b){for(var c=0;c<a.length;){var d=a.splice(0,1)[0];d.canvasPosition=d.canvasPosition||{};this.canvasRenderContext(d,b)}};html2canvas.prototype.canvasRenderer=function(a){var b=this;this.sortZ(this.zStack);a=this.queue;this.canvas.width=Math.max(jQuery(document).width(),this.opts.canvasWidth);this.canvas.height=Math.max(jQuery(document).height(),this.opts.canvasHeight);this.ctx=this.canvas.getContext("2d");this.canvasRenderStorage(a,this.ctx)};html2canvas.prototype.setContextVariable=function(a,b,c){if(!a.storage){a[b]=c}else{a.storage.push({type:"variable",name:b,arguments:c})}};html2canvas.prototype.drawListItem=function(a,b,c){var d=this.getCSS(a,"list-style-position",false);var e=this.getListItem(a),f,g;var h=this.getCSS(a,"list-style-type",false);if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(h)){var i=jQuery(a).index()+1,j;if(h=="decimal"){j=i}else if(h=="decimal-leading-zero"){if(i.toString().length==1){j=i="0"+i.toString()}else{j=i.toString()}}else if(h=="upper-roman"){j=this.getListRoman(i)}else if(h=="lower-roman"){j=this.getListRoman(i).toLowerCase()}else if(h=="lower-alpha"){j=this.getListAlpha(i).toLowerCase()}else if(h=="upper-alpha"){j=this.getListAlpha(i)}j+=". ";var k=this.getListPosition(a,j);if(d=="inside"){this.setFont(b.ctx,a,false);f=c.left}else{return;this.setFont(b.ctx,a,true);f=c.left-10}g=k.bottom;this.printText(j,f,g,b.ctx)}};html2canvas.prototype.getListPosition=function(a,b){var c=document.createElement("boundelement");c.style.display="inline";var d=a.style.listStyleType;a.style.listStyleType="none";c.appendChild(document.createTextNode(b));a.insertBefore(c,a.firstChild);var e=this.getBounds(c);a.removeChild(c);a.style.listStyleType=d;return e};html2canvas.prototype.getListItem=function(a){};html2canvas.prototype.getListAlpha=function(a){var b="";do{var c=a%26;b=String.fromCharCode(c+64)+b;a=a/26}while(a*26>26);return b};html2canvas.prototype.getListRoman=function(a){var b=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],c=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],d="";if(a<=0||a>=4e3)return;for(var e=0;e<b.length;e++){while(a>=c[e]){a-=c[e];d+=b[e]}}return d};html2canvas.prototype.newText=function(a,b,c,d){var e=c.ctx;var f=this.getCSS(a,"font-family");var g=this.getCSS(a,"font-size");var h=this.getCSS(a,"color");var i=this.getCSS(a,"text-decoration");var j=this.getCSS(a,"text-align");var k=this.getCSS(a,"letter-spacing");b.nodeValue=this.textTransform(b.nodeValue,this.getCSS(a,"text-transform"));var l=this.trim(b.nodeValue);if(l.length>0){if(i!="none"){var m=this.fontMetrics(f,g)}var n,o=false;j=j.replace(["-webkit-auto"],["auto"]);if(this.opts.letterRendering==false&&/^(left|right|justify|auto)$/.test(j)&&/^(normal|none)$/.test(k)){o=true;n=b.nodeValue.split(/(\b| )/)}else{n=b.nodeValue.split("")}this.setFont(e,a,false);var p=b;for(var q=0;q<n.length;q++){if(typeof p.nodeValue!="string"){continue}var r=p.splitText(n[q].length);if(i!="none"||this.trim(p.nodeValue).length!=0){if(this.support.rangeBounds){if(document.createRange){var s=document.createRange();s.selectNode(p)}else{var s=document.body.createTextRange()}if(s.getBoundingClientRect()){var t=s.getBoundingClientRect()}else{var t={}}}else{var u=p.parentNode;var v=document.createElement("wrapper");var w=p.cloneNode(true);v.appendChild(p.cloneNode(true));u.replaceChild(v,p);var t=this.getBounds(v);u.replaceChild(w,v)}this.printText(p.nodeValue,t.left,t.bottom,e);switch(i){case"underline":this.newRect(e,t.left,Math.round(t.top+m.baseline+m.lineWidth),t.width,1,h);break;case"overline":this.newRect(e,t.left,t.top,t.width,1,h);break;case"line-through":this.newRect(e,t.left,Math.ceil(t.top+m.middle+m.lineWidth),t.width,1,h);break}}p=r}}};html2canvas.prototype.setFont=function(a,b,c){var d=this.getCSS(b,"font-family");var e=this.getCSS(b,"font-size");var f=this.getCSS(b,"color");var g=this.getCSS(b,"font-weight");var h=this.getCSS(b,"font-style");var i=this.getCSS(b,"font-variant");switch(g){case 401:g="bold";break;case 400:g="normal";break}var j=i+" "+g+" "+h+" "+e+" "+d;this.setContextVariable(a,"fillStyle",f);this.setContextVariable(a,"font",j);if(c){this.setContextVariable(a,"textAlign","right")}else{this.setContextVariable(a,"textAlign","left")}};html2canvas.prototype.fontMetrics=function(a,b){var c=this.fontData.indexOf(a+"-"+b);if(c>-1){return this.fontData[c+1]}var d=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(d);jQuery(d).css({visibility:"hidden",fontFamily:a,fontSize:b,margin:0,padding:0});var e=document.createElement("img");e.src="http://html2canvas.hertzen.com/images/8.jpg";e.width=1;e.height=1;jQuery(e).css({margin:0,padding:0});var f=document.createElement("span");jQuery(f).css({fontFamily:a,fontSize:b,margin:0,padding:0});f.appendChild(document.createTextNode("Hidden Text"));d.appendChild(f);d.appendChild(e);var g=e.offsetTop-f.offsetTop+1;d.removeChild(f);d.appendChild(document.createTextNode("Hidden Text"));jQuery(d).css("line-height","normal");jQuery(e).css("vertical-align","super");var h=e.offsetTop-d.offsetTop+1;var i={baseline:g,lineWidth:1,middle:h};this.fontData.push(a+"-"+b);this.fontData.push(i);jQuery(d).remove();return i};html2canvas.prototype.textTransform=function(a,b){switch(b){case"lowercase":return a.toLowerCase();break;case"capitalize":return a.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(a,b,c){return b+c.toUpperCase()});break;case"uppercase":return a.toUpperCase();break;default:return a}};html2canvas.prototype.trim=function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")};html2canvas.prototype.parseElement=function(a,b){var c=this;this.each(a.children,function(a,d){c.parsing(d,b)});this.log("Render queue stored");this.opts.storageReady(this);this.finish()};html2canvas.prototype.parsing=function(a,b){if(this.getCSS(a,"display")!="none"&&this.getCSS(a,"visibility")!="hidden"){var c=this;b=this.newElement(a,b)||b;var d=b.ctx;if(!this.ignoreRe.test(a.nodeName)){this.each(this.contentsInZ(a),function(d,e){if(e.nodeType==1){c.parsing(e,b)}else if(e.nodeType==3){c.newText(a,e,b)}})}}};html2canvas.prototype.log=function(a){if(this.opts.logging){this.opts.logger(a)}};html2canvas.prototype.withinBounds=function(a,b){if(!a)return true;return(a.left<=b.left||b.left+b.width<a.left)&&(a.top<=b.top||b.top+b.height<a.top)};html2canvas.prototype.clipBounds=function(a,b){var c=Math.max(a.left,b.left);var d=Math.max(a.top,b.top);var e=Math.min(a.left+a.width,b.left+b.width);var f=Math.min(a.top+a.height,b.top+b.height);return{left:c,top:d,width:e-c,height:f-d}};html2canvas.prototype.getBounds=function(a){window.scroll(0,0);if(a.getBoundingClientRect){var b=a.getBoundingClientRect();var c={};c.top=b.top;c.bottom=b.bottom||b.top+b.height;c.left=b.left;c.width=b.width;c.height=b.height;return c}else{var d=jQuery(a).offset();return{left:d.left+this.getCSS(a,"border-left-width",true),top:d.top+this.getCSS(a,"border-top-width",true),width:jQuery(a).innerWidth(),height:jQuery(a).innerHeight()}}};html2canvas.prototype.each=function(a,b){b=b||function(){};for(var c=0;c<a.length;c++){if(b(c,a[c])===false)return}};html2canvas.prototype.contentsInZ=function(a){var b=jQuery(a).contents();return b};html2canvas.prototype.getAttr=function(a,b){return a.getAttribute(b)};html2canvas.prototype.extendObj=function(a,b){for(var c in a){b[c]=a[c]}return b};html2canvas.prototype.zContext=function(a){return{zindex:a,children:[]}};html2canvas.prototype.setZ=function(a,b,c,d){if(!c){this.zStack=new this.zContext(0);return this.zStack}if(a!="auto"){this.needReorder=true;var e=new this.zContext(a);c.children.push(e);return e}else{return c}};html2canvas.prototype.sortZ=function(a){var b=[];var c=[];var d=this;this.each(a.children,function(a,e){if(e.children&&e.children.length>0){b.push(e);c.push(e.zindex)}else{d.queue.push(e)}});c.sort(function(a,b){return a-b});this.each(c,function(a,c){for(var e=0;e<=b.length;e++){if(b[e].zindex==c){var f=b.splice(e,1);d.sortZ(f[0]);break}}})};html2canvas.prototype.getContents=function(a){return a.nodeName=="iframe"?a.contentDocument||a.contentWindow.document:a.childNodes};html2canvas.prototype.getCSS=function(a,b,c){if(c){return parseInt(jQuery(a).css(b),10)}else{return jQuery(a).css(b)}};html2canvas.prototype.getIndex=function(a,b){if(a.indexOf){return a.indexOf(b)}else{for(var c=0;c<a.length;c++){if(this[c]==b)return c}return-1}};html2canvas.prototype.isSameOrigin=function(a){var b=document.createElement("a");b.href=a;return b.protocol+b.host==this.pageOrigin};html2canvas.prototype.inArray=function(a,b,c){var d="",e=!!c;if(e){for(d in b){if(b[d]===a){return true}}}else{for(d in b){if(b[d]==a){return true}}}return false};
